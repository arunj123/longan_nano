#include "font_big.h"
#include "lcd.h"

// Framebuffer is defined in main.c
extern uint16_t g_fb[LCD_FRAMEBUFFER_PIXELS];

// 16x24 Font Data (each character is 24 rows, 2 bytes per row)
// A limited set of characters is included for this example.
static const unsigned char font_big_data[256][48] = {
    [' '] = {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['!'] = {0x00,0x00,0x06,0x60,0x06,0x60,0x06,0x60,0x06,0x60,0x06,0x60,0x06,0x60,0x06,0x60,0x06,0x60,0x06,0x60,0x00,0x00,0x06,0x60,0x06,0x60,0x06,0x60,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['"'] = {0x19,0x80,0x19,0x80,0x19,0x80,0x19,0x80,0x0c,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['A'] = {0x00,0x00,0x01,0x80,0x03,0xc0,0x03,0xc0,0x06,0x60,0x0c,0x30,0x0c,0x30,0x18,0x18,0x18,0x18,0x3f,0xfc,0x3f,0xfc,0x30,0x0c,0x60,0x06,0x60,0x06,0xc0,0x03,0xc0,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['B'] = {0x00,0x00,0x3f,0xf0,0x3f,0xf0,0x30,0x60,0x30,0x60,0x30,0x60,0x30,0x60,0x3f,0xe0,0x3f,0xe0,0x30,0x60,0x30,0x60,0x30,0x60,0x30,0x60,0x3f,0xf0,0x3f,0xf0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['C'] = {0x00,0x00,0x0f,0xe0,0x1f,0xf0,0x30,0x60,0x60,0x30,0x60,0x00,0x60,0x00,0x60,0x00,0x60,0x00,0x60,0x00,0x60,0x30,0x30,0x60,0x1f,0xf0,0x0f,0xe0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['D'] = {0x00,0x00,0x3f,0xc0,0x3f,0xc0,0x30,0x60,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x60,0x3f,0xc0,0x3f,0xc0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['E'] = {0x00,0x00,0x3f,0xfc,0x3f,0xfc,0x30,0x00,0x30,0x00,0x30,0x00,0x3f,0xc0,0x3f,0xc0,0x30,0x00,0x30,0x00,0x30,0x00,0x30,0x00,0x3f,0xfc,0x3f,0xfc,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['F'] = {0x00,0x00,0x3f,0xfc,0x3f,0xfc,0x30,0x00,0x30,0x00,0x30,0x00,0x3f,0xc0,0x3f,0xc0,0x30,0x00,0x30,0x00,0x30,0x00,0x30,0x00,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['G'] = {0x00,0x00,0x0f,0xe0,0x1f,0xf0,0x30,0x60,0x60,0x00,0x60,0x00,0x60,0x78,0x60,0x78,0x60,0x60,0x60,0x30,0x30,0x30,0x1f,0xf0,0x0f,0xe0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['H'] = {0x00,0x00,0x30,0x0c,0x30,0x0c,0x30,0x0c,0x30,0x0c,0x30,0x0c,0x3f,0xfc,0x3f,0xfc,0x30,0x0c,0x30,0x0c,0x30,0x0c,0x30,0x0c,0x30,0x0c,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['I'] = {0x00,0x00,0x0f,0xc0,0x0f,0xc0,0x03,0x00,0x03,0x00,0x03,0x00,0x03,0x00,0x03,0x00,0x03,0x00,0x03,0x00,0x03,0x00,0x0f,0xc0,0x0f,0xc0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['J'] = {0x00,0x00,0x00,0x78,0x00,0x78,0x00,0x30,0x00,0x30,0x00,0x30,0x00,0x30,0x30,0x30,0x30,0x30,0x3f,0xf0,0x1f,0xc0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['K'] = {0x00,0x00,0x30,0x18,0x30,0x30,0x30,0x60,0x30,0xc0,0x31,0x80,0x33,0x00,0x36,0x00,0x3c,0x00,0x36,0x00,0x33,0x00,0x31,0x80,0x30,0xc0,0x30,0x60,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['L'] = {0x00,0x00,0x30,0x00,0x30,0x00,0x30,0x00,0x30,0x00,0x30,0x00,0x30,0x00,0x30,0x00,0x30,0x00,0x30,0x00,0x30,0x00,0x3f,0xfc,0x3f,0xfc,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['M'] = {0x00,0x00,0x60,0x06,0x60,0x06,0x63,0x86,0x63,0x86,0x67,0xc6,0x67,0xc6,0x6f,0xe6,0x6f,0xe6,0x60,0x06,0x60,0x06,0x60,0x06,0x60,0x06,0x60,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['N'] = {0x00,0x00,0x60,0x06,0x60,0x06,0x61,0x86,0x63,0x86,0x63,0xce,0x67,0xce,0x67,0xee,0x6f,0xee,0x6f,0x86,0x60,0x86,0x60,0x06,0x60,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['O'] = {0x00,0x00,0x0f,0xe0,0x1f,0xf0,0x30,0x30,0x60,0x18,0x60,0x18,0x60,0x18,0x60,0x18,0x60,0x18,0x30,0x30,0x1f,0xf0,0x0f,0xe0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['P'] = {0x00,0x00,0x3f,0xf0,0x3f,0xf0,0x30,0x60,0x30,0x60,0x30,0x60,0x3f,0xf0,0x3f,0xf0,0x30,0x00,0x30,0x00,0x30,0x00,0x30,0x00,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['Q'] = {0x00,0x00,0x0f,0xe0,0x1f,0xf0,0x30,0x30,0x60,0x18,0x60,0x18,0x60,0x18,0x60,0x18,0x60,0x18,0x30,0x30,0x1f,0xf0,0x0f,0xe0,0x00,0x30,0x00,0x60,0x00,0xc0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['R'] = {0x00,0x00,0x3f,0xf0,0x3f,0xf0,0x30,0x60,0x30,0x60,0x30,0x60,0x3f,0xf0,0x3f,0xf0,0x33,0x00,0x31,0x80,0x30,0xc0,0x30,0x60,0x30,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['S'] = {0x00,0x00,0x0f,0xe0,0x1f,0xf0,0x30,0x60,0x30,0x00,0x1e,0x00,0x0f,0xc0,0x07,0x80,0x00,0x60,0x00,0x30,0x60,0x30,0x3f,0xf8,0x1f,0xf0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['T'] = {0x00,0x00,0x7f,0xfe,0x7f,0xfe,0x0c,0x30,0x0c,0x30,0x0c,0x30,0x0c,0x30,0x0c,0x30,0x0c,0x30,0x0c,0x30,0x0c,0x30,0x0c,0x30,0x0c,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['U'] = {0x00,0x00,0x60,0x06,0x60,0x06,0x60,0x06,0x60,0x06,0x60,0x06,0x60,0x06,0x60,0x06,0x60,0x06,0x30,0x30,0x1f,0xf0,0x0f,0xe0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['V'] = {0x00,0x00,0xc0,0x03,0xc0,0x03,0x60,0x06,0x60,0x06,0x30,0x0c,0x30,0x0c,0x18,0x18,0x18,0x18,0x0c,0x30,0x0c,0x30,0x06,0x60,0x03,0xc0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['W'] = {0x00,0x00,0xc0,0x03,0xc0,0x03,0xc0,0x03,0xc0,0x03,0x60,0x06,0x60,0x06,0x6f,0xe6,0x6f,0xe6,0x3f,0xfc,0x38,0x1c,0x38,0x1c,0x18,0x18,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['X'] = {0x00,0x00,0x60,0x06,0x30,0x0c,0x30,0x0c,0x18,0x18,0x0c,0x30,0x0c,0x30,0x07,0xe0,0x0c,0x30,0x0c,0x30,0x18,0x18,0x30,0x0c,0x60,0x06,0x60,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['Y'] = {0x00,0x00,0x60,0x06,0x60,0x06,0x30,0x0c,0x18,0x18,0x0c,0x30,0x0c,0x30,0x0c,0x30,0x0c,0x30,0x0c,0x30,0x0c,0x30,0x0c,0x30,0x0c,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
    ['Z'] = {0x00,0x00,0x7f,0xf8,0x7f,0xf8,0x00,0x60,0x00,0xc0,0x01,0x80,0x03,0x00,0x06,0x00,0x0c,0x00,0x18,0x00,0x30,0x00,0x60,0x00,0x7f,0xf8,0x7f,0xf8,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
};

void draw_char_big(int x, int y, char c, uint16_t color) {
    if (x < 0 || x + 16 > LCD_WIDTH || y < 0 || y + 24 > LCD_HEIGHT) {
        return;
    }

    const unsigned char *glyph = font_big_data[(unsigned char)c];

    for (int i = 0; i < 24; i++) { // 24 rows
        unsigned char row_byte1 = glyph[i * 2];
        unsigned char row_byte2 = glyph[i * 2 + 1];

        for (int j = 0; j < 8; j++) { // First 8 pixels
            if ((row_byte1 >> (7 - j)) & 1) {
                g_fb[(y + i) * LCD_WIDTH + (x + j)] = color;
            }
        }
        for (int j = 0; j < 8; j++) { // Next 8 pixels
            if ((row_byte2 >> (7 - j)) & 1) {
                g_fb[(y + i) * LCD_WIDTH + (x + 8 + j)] = color;
            }
        }
    }
}

void draw_string_big(int x, int y, const char* str, uint16_t color) {
    while (*str) {
        draw_char_big(x, y, *str, color);
        x += 16;
        // Wrap to next line if needed
        if (x + 16 > LCD_WIDTH) {
            x = 0;
            y += 24;
        }
        str++;
    }
}